---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "clevercloud_ruby Resource - terraform-provider-clevercloud"
description: |-
  Ruby resource
  Manage a Ruby application on Clever Cloud.
  Example Usage
  
  # Simple Ruby application
  resource "clevercloud_ruby" "simple_ruby_app" {
    name               = "my-ruby-app"
    region             = "par"
    min_instance_count = 1
    max_instance_count = 2
    smallest_flavor    = "XS" 
    biggest_flavor     = "M"
    ruby_version       = "3.3"
  }
  
  # Ruby on Rails application with database and custom configuration
  resource "clevercloud_ruby" "rails_app" {
    name               = "my-rails-app"
    region             = "par"
    min_instance_count = 1
    max_instance_count = 4
    smallest_flavor    = "XS"
    biggest_flavor     = "L"
    build_flavor       = "XL"
    
    ruby_version       = "3.3.1"
    rails_env          = "production"
    rake_goals         = "db:migrate,assets:precompile"
    enable_sidekiq     = true
    sidekiq_files      = "./config/sidekiq.yml"
    
    environment = {
      SECRET_KEY_BASE = "your-secret-key"
      DATABASE_URL    = "postgresql://..."
    }
    
    deployment {
      repository = "https://github.com/your-org/your-rails-app.git"
      commit     = "main"
    }
    
    depends_on = [clevercloud_postgresql.db]
  }
  
  # Ruby application with custom server and static files
  resource "clevercloud_ruby" "custom_ruby_app" {
    name               = "custom-ruby-app"
    region             = "par"
    min_instance_count = 2
    max_instance_count = 6
    smallest_flavor    = "S"
    biggest_flavor     = "XL"
    
    ruby_version        = "3.2"
    rackup_server      = "unicorn"
    rack_env           = "production"
    static_files_path  = "public"
    static_url_prefix  = "/assets"
    
    enable_gzip_compression = true
    nginx_read_timeout     = 600
    
    hooks {
      pre_build  = "bundle config set --local deployment true"
      post_build = "bundle exec rake assets:precompile"
    }
  }
  
  Note: For deploying from private GitHub repositories, see the private repository deployment guide https://registry.terraform.io/providers/CleverCloud/clevercloud/latest/docs#applications-private-repository-deployment.
---

# clevercloud_ruby (Resource)

# Ruby resource

Manage a Ruby application on Clever Cloud.

## Example Usage

```terraform
# Simple Ruby application
resource "clevercloud_ruby" "simple_ruby_app" {
  name               = "my-ruby-app"
  region             = "par"
  min_instance_count = 1
  max_instance_count = 2
  smallest_flavor    = "XS" 
  biggest_flavor     = "M"
  ruby_version       = "3.3"
}

# Ruby on Rails application with database and custom configuration
resource "clevercloud_ruby" "rails_app" {
  name               = "my-rails-app"
  region             = "par"
  min_instance_count = 1
  max_instance_count = 4
  smallest_flavor    = "XS"
  biggest_flavor     = "L"
  build_flavor       = "XL"
  
  ruby_version       = "3.3.1"
  rails_env          = "production"
  rake_goals         = "db:migrate,assets:precompile"
  enable_sidekiq     = true
  sidekiq_files      = "./config/sidekiq.yml"
  
  environment = {
    SECRET_KEY_BASE = "your-secret-key"
    DATABASE_URL    = "postgresql://..."
  }
  
  deployment {
    repository = "https://github.com/your-org/your-rails-app.git"
    commit     = "main"
  }
  
  depends_on = [clevercloud_postgresql.db]
}

# Ruby application with custom server and static files
resource "clevercloud_ruby" "custom_ruby_app" {
  name               = "custom-ruby-app"
  region             = "par"
  min_instance_count = 2
  max_instance_count = 6
  smallest_flavor    = "S"
  biggest_flavor     = "XL"
  
  ruby_version        = "3.2"
  rackup_server      = "unicorn"
  rack_env           = "production"
  static_files_path  = "public"
  static_url_prefix  = "/assets"
  
  enable_gzip_compression = true
  nginx_read_timeout     = 600
  
  hooks {
    pre_build  = "bundle config set --local deployment true"
    post_build = "bundle exec rake assets:precompile"
  }
}
```

**Note**: For deploying from private GitHub repositories, see the [private repository deployment guide](https://registry.terraform.io/providers/CleverCloud/clevercloud/latest/docs#applications-private-repository-deployment).



<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `biggest_flavor` (String) Biggest instance flavor, if different from smallest, enable auto-scaling
- `max_instance_count` (Number) Maximum instance count, if different from min value, enable auto-scaling
- `min_instance_count` (Number) Minimum instance count
- `name` (String) Application name
- `smallest_flavor` (String) Smallest instance flavor

### Optional

- `app_folder` (String) Folder in which the application is located (inside the git repository)
- `build_flavor` (String) Use dedicated instance with given flavor for build phase
- `dependencies` (Set of String) A list of application or add-ons required to run this application.
Can be either app_xxx or postgres_yyy ID format
- `deployment` (Block, Optional) (see [below for nested schema](#nestedblock--deployment))
- `description` (String) Application description
- `enable_gzip_compression` (Boolean) Set to true to gzip-compress through Nginx
- `enable_sidekiq` (Boolean) Enable Sidekiq background process
- `environment` (Map of String, Sensitive) Environment variables injected into the application
- `exposed_environment` (Map of String, Sensitive) Environment variables other linked applications will be able to use
- `gzip_types` (String) Set the mime types to compress (default: 'text/* application/json application/xml application/javascript image/svg+xml')
- `hooks` (Block, Optional) (see [below for nested schema](#nestedblock--hooks))
- `http_basic_auth` (String, Sensitive) Restrict HTTP access to your application (format: 'login:password')
- `integrations` (Attributes) Third-party integrations configuration (see [below for nested schema](#nestedatt--integrations))
- `networkgroups` (Attributes Set) List of networkgroups the application must be part of (see [below for nested schema](#nestedatt--networkgroups))
- `nginx_proxy_buffer_size` (String) Sets the size of the buffer used for reading the first part of the response received from the proxied server
- `nginx_proxy_buffers` (String) Sets the number and size of the buffers used for reading a response from the proxied server
- `nginx_read_timeout` (Number) Read timeout in seconds (default: 300)
- `rack_env` (String) Rack environment variable
- `rackup_server` (String) Server to use for serving the Ruby application (default: puma)
- `rails_env` (String) Rails environment variable
- `rake_goals` (String) Comma-separated list of rake goals to execute (e.g., 'db:migrate,assets:precompile')
- `redirect_https` (Boolean) Redirect client from plain to TLS port
- `region` (String) Geographical region where the database will be deployed
- `ruby_version` (String) Ruby version to use (e.g., '3.3', '3.3.1')
- `sidekiq_files` (String) Specify a list of Sidekiq configuration files (e.g., './config/sidekiq_1.yml,./config/sidekiq_2.yml')
- `static_files_path` (String) Relative path to where your static files are stored
- `static_url_prefix` (String) The URL path under which you want to serve static files, usually /public
- `static_webroot` (String) Path to the web content to serve, relative to the root of your application
- `sticky_sessions` (Boolean) Enable sticky sessions, use it when your client sessions are instances scoped
- `vhosts` (Attributes Set) List of virtual hosts (see [below for nested schema](#nestedatt--vhosts))

### Read-Only

- `deploy_url` (String) Git URL used to push source code
- `deployed_commit` (String) The commit hash currently deployed on the application
- `id` (String) Unique identifier generated during application creation

<a id="nestedblock--deployment"></a>
### Nested Schema for `deployment`

Optional:

- `authentication_basic` (String, Sensitive) user ans password ':' separated, (PersonalAccessToken in Github case)
- `commit` (String) Support multiple syntax like `refs/heads/[BRANCH]`, `github_hook` or `[COMMIT]`, when using the special value `github_hook`, we will link the application to the Github repository
- `repository` (String) The repository URL to deploy, can be 'https://...', 'file://...'


<a id="nestedblock--hooks"></a>
### Nested Schema for `hooks`

Optional:

- `post_build` (String) [CC_POST_BUILD_HOOK](https://www.clever.cloud/developers/doc/develop/build-hooks/#post-build)
- `pre_build` (String) [CC_PRE_BUILD_HOOK](https://www.clever.cloud/developers/doc/develop/build-hooks/#pre-build)
- `pre_run` (String) [CC_PRE_RUN_HOOK](https://www.clever.cloud/developers/doc/develop/build-hooks/#pre-run)
- `run_failed` (String) [CC_RUN_FAILED_HOOK](https://www.clever.cloud/developers/doc/develop/build-hooks/#run-successfail)
- `run_succeed` (String) [CC_RUN_SUCCEEDED_HOOK](https://www.clever.cloud/developers/doc/develop/build-hooks/#run-successfail)


<a id="nestedatt--integrations"></a>
### Nested Schema for `integrations`

Optional:

- `clamav` (Attributes) ClamAV antivirus integration for file scanning (see [below for nested schema](#nestedatt--integrations--clamav))
- `newrelic` (Attributes) New Relic APM integration for application performance monitoring (see [below for nested schema](#nestedatt--integrations--newrelic))
- `pgpoolii` (Attributes) PgPool-II configuration. [Learn more](https://www.clever.cloud/developers/doc/reference/reference-environment-variables#pgpool-ii) (see [below for nested schema](#nestedatt--integrations--pgpoolii))
- `prometheus` (Attributes) Prometheus metrics integration. See [Prometheus docs](https://www.clever.cloud/developers/doc/reference/reference-environment-variables#prometheus) (see [below for nested schema](#nestedatt--integrations--prometheus))
- `redirectionio` (Attributes) Redirection.io integration for URL redirection and traffic management. See [Redirection.io docs](https://www.clever.cloud/developers/doc/reference/reference-environment-variables#redirectionio) (see [below for nested schema](#nestedatt--integrations--redirectionio))
- `varnish` (Attributes) Varnish cache integration for HTTP acceleration. See [Varnish docs](https://www.clever.cloud/developers/doc/reference/reference-environment-variables#varnish) (see [below for nested schema](#nestedatt--integrations--varnish))

<a id="nestedatt--integrations--clamav"></a>
### Nested Schema for `integrations.clamav`

Optional:

- `enabled` (Boolean) Enable ClamAV antivirus ([CC_CLAMAV](https://www.clever.cloud/developers/doc/reference/reference-environment-variables#clamav))


<a id="nestedatt--integrations--newrelic"></a>
### Nested Schema for `integrations.newrelic`

Required:

- `license_key` (String, Sensitive) Your New Relic license key ([NEW_RELIC_LICENSE_KEY](https://www.clever.cloud/developers/doc/reference/reference-environment-variables#new-relic))

Optional:

- `app_name` (String) Application name in New Relic ([NEW_RELIC_APP_NAME](https://www.clever.cloud/developers/doc/reference/reference-environment-variables#new-relic))


<a id="nestedatt--integrations--pgpoolii"></a>
### Nested Schema for `integrations.pgpoolii`

Optional:

- `enabled` (Boolean) Enable PgPool-II connection pooler ([CC_ENABLE_PGPOOL](https://www.clever.cloud/developers/doc/reference/reference-environment-variables#pgpool-ii))


<a id="nestedatt--integrations--prometheus"></a>
### Nested Schema for `integrations.prometheus`

Optional:

- `password` (String, Sensitive) Define the password for the basic auth of the Prometheus endpoint ([CC_METRICS_PROMETHEUS_PASSWORD](https://www.clever.cloud/developers/doc/reference/reference-environment-variables#prometheus))
- `path` (String) Define the path on which the Prometheus endpoint is available ([CC_METRICS_PROMETHEUS_PATH](https://www.clever.cloud/developers/doc/reference/reference-environment-variables#prometheus)). Default: `/metrics`
- `port` (Number) Define the port on which the Prometheus endpoint is available ([CC_METRICS_PROMETHEUS_PORT](https://www.clever.cloud/developers/doc/reference/reference-environment-variables#prometheus)). Default: `9100`
- `response_timeout` (Number) Define the timeout in seconds to collect the application metrics. This value must be below 60 seconds ([CC_METRICS_PROMETHEUS_RESPONSE_TIMEOUT](https://www.clever.cloud/developers/doc/reference/reference-environment-variables#prometheus)). Default: `3`
- `user` (String) Define the user for the basic auth of the Prometheus endpoint ([CC_METRICS_PROMETHEUS_USER](https://www.clever.cloud/developers/doc/reference/reference-environment-variables#prometheus))


<a id="nestedatt--integrations--redirectionio"></a>
### Nested Schema for `integrations.redirectionio`

Required:

- `project_key` (String, Sensitive) Your Redirection.io project key ([CC_REDIRECTIONIO_PROJECT_KEY](https://www.clever.cloud/developers/doc/reference/reference-environment-variables#redirectionio))

Optional:

- `backend_port` (Number) Backend application port ([CC_REDIRECTIONIO_BACKEND_PORT](https://www.clever.cloud/developers/doc/reference/reference-environment-variables#redirectionio))
- `instance_name` (String) Custom instance name for the Redirection.io agent ([CC_REDIRECTIONIO_INSTANCE_NAME](https://www.clever.cloud/developers/doc/reference/reference-environment-variables#redirectionio))


<a id="nestedatt--integrations--varnish"></a>
### Nested Schema for `integrations.varnish`

Optional:

- `config_file` (String) Path to the Varnish configuration file, relative to your application root ([CC_VARNISH_FILE](https://www.clever.cloud/developers/doc/reference/reference-environment-variables#varnish)). Default: `/clevercloud/varnish.vcl`
- `storage_size` (String) Configure the size of the Varnish cache ([CC_VARNISH_STORAGE_SIZE](https://www.clever.cloud/developers/doc/reference/reference-environment-variables#varnish)). Default: `1G`



<a id="nestedatt--networkgroups"></a>
### Nested Schema for `networkgroups`

Required:

- `fqdn` (String) domain name which will resolve to application instances inside the networkgroup
- `networkgroup_id` (String) ID of the networkgroup


<a id="nestedatt--vhosts"></a>
### Nested Schema for `vhosts`

Required:

- `fqdn` (String) Fully qualified domain name

Optional:

- `path_begin` (String) Any HTTP request starting with this path will be sent to this application
