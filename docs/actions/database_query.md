---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "clevercloud_database_query Action - terraform-provider-clevercloud"
subcategory: ""
description: |-
  Action used to execute SQL queries on database addons
  This action executes a SQL query on a Clever Cloud database addon (currently PostgreSQL only) and optionally exports the results to a JSON file.
  Basic Usage
  Execute a query without saving results:
  
  terraform {
    required_version = ">= 1.14.0"
  
    required_providers {
      clevercloud = {
        source  = "CleverCloud/clevercloud"
        version = "1.8.0"
      }
    }
  }
  
  provider "clevercloud" {
    organisation = "orga_xxx"
  }
  
  action "clevercloud_database_query" "create_table" {
    config {
      database_id = "postgresql_16247e01-849e-4z95-b5ca-be883e849562"
      query       = "CREATE TABLE IF NOT EXISTS users (
          id SERIAL PRIMARY KEY,
          name VARCHAR(100),
          email VARCHAR(100)
        )"
    }
  }
  
  Exporting Results to JSON
  Use the output_json attribute to export query results to a file.
  When an output is expected, only one SQL statement is allowed.
  
  action "clevercloud_database_query" "export_users" {
    config {
      database_id = "postgresql_16247e01-849e-4z95-b5ca-be883e849562"
      query       = "SELECT id, name, email FROM users WHERE active = true ORDER BY id"
      output_json = "file://./query_results.json"
    }
  }
  
  Manual Trigger
  
  terraform apply -invoke action.clevercloud_database_query.export_users
  
  Output Format
  When using output_json, results are saved as a JSON array of objects. Each object represents a row with column names as keys and their corresponding values:
  
  [
    {
      "id": 1,
      "name": "John Doe",
      "email": "john@example.com"
    },
    {
      "id": 2,
      "name": "Jane Smith",
      "email": "jane@example.com"
    }
  ]
  
  Data Type Handling:
  PostgreSQL types are mapped to JSON types automaticallyNumbers: INTEGER, BIGINT → JSON numbers (int32, int64)Text: VARCHAR, TEXT → JSON stringsBoolean: BOOLEAN → JSON boolean (true/false)Decimals: NUMERIC, DECIMAL → numeric valuesNULL values → JSON null
  Supported Databases
  Currently, this action supports:
  PostgreSQL databases (database_id starting with postgresql_)
---

# clevercloud_database_query (Action)

> Action used to execute SQL queries on database addons

This action executes a SQL query on a Clever Cloud database addon (currently PostgreSQL only) and optionally exports the results to a JSON file.

## Basic Usage

Execute a query without saving results:

```hcl
terraform {
  required_version = ">= 1.14.0"

  required_providers {
    clevercloud = {
      source  = "CleverCloud/clevercloud"
      version = "1.8.0"
    }
  }
}

provider "clevercloud" {
  organisation = "orga_xxx"
}

action "clevercloud_database_query" "create_table" {
  config {
    database_id = "postgresql_16247e01-849e-4z95-b5ca-be883e849562"
    query       = "CREATE TABLE IF NOT EXISTS users (
        id SERIAL PRIMARY KEY,
        name VARCHAR(100),
        email VARCHAR(100)
      )"
  }
}
```

## Exporting Results to JSON

Use the `output_json` attribute to export query results to a file.

> When an output is expected, only one SQL statement is allowed.

```hcl
action "clevercloud_database_query" "export_users" {
  config {
    database_id = "postgresql_16247e01-849e-4z95-b5ca-be883e849562"
    query       = "SELECT id, name, email FROM users WHERE active = true ORDER BY id"
    output_json = "file://./query_results.json"
  }
}
```

### Manual Trigger

```sh
terraform apply -invoke action.clevercloud_database_query.export_users
```

## Output Format

When using `output_json`, results are saved as a JSON array of objects. Each object represents a row with column names as keys and their corresponding values:

```json
[
  {
    "id": 1,
    "name": "John Doe",
    "email": "john@example.com"
  },
  {
    "id": 2,
    "name": "Jane Smith",
    "email": "jane@example.com"
  }
]
```

**Data Type Handling:**
- PostgreSQL types are mapped to JSON types automatically
- Numbers: INTEGER, BIGINT → JSON numbers (int32, int64)
- Text: VARCHAR, TEXT → JSON strings
- Boolean: BOOLEAN → JSON boolean (true/false)
- Decimals: NUMERIC, DECIMAL → numeric values
- NULL values → JSON null

## Supported Databases

Currently, this action supports:
- PostgreSQL databases (database_id starting with `postgresql_`)



<!-- action schema generated by tfplugindocs -->
## Schema

### Required

- `database_id` (String) Database ID to execute the query on
- `query` (String) SQL query to execute

### Optional

- `output_json` (String) file path and name to write query result into, starts with file://
